<!-- <video #streamView width="400" autoplay>
  <source type='video/webm; codecs="opus,vp8"'>
  Your browser does not support HTML5 video.
</video> -->

<!-- <ng-template [ngIf]="toggle">
  <div *ngFor="let obj of this.peerConnList">
    {{obj.remote_user}}
    <video width="400" [srcObject]="obj.remoteStream" autoplay>
    </video>
  </div>
</ng-template> -->


<!-- <ng-select [(ngModel)]="selectedRoom">
  <ng-option *ngFor="let room of getRoomList()" [value]="room">{{room.id}}</ng-option>
</ng-select> -->

<hr />
<video id="local-video-container" #streamView width="40" height="40" autoplay>
  <source type='video/webm; codecs="opus,vp8"'>
  Your browser does not support HTML5 video.
</video>
<div id="remote-video-container" *ngFor="let obj of this.peerConnList">
  <video width="40" height="40" [srcObject]="obj.remoteStream" autoplay>
  </video>
</div>

<!--<ng-template [ngIf]="toggle">-->
<!--  <div *ngFor="let obj of this.peerConnList">-->
<!--    {{obj.remote_user}}-->
<!--    <video width="400" [srcObject]="obj.remoteStream" autoplay>-->
<!--    </video>-->
<!--  </div>-->
<!--</ng-template>-->

<!-- <ul class="rooms list-group">
  <li *ngFor="let room of getRoomList()" class="room list-group-item"
    [ngClass]="{ 'active': room.id === selectedRoom?.id }" (click)="onClickOnRoom(room)">
    {{ room.id }}</li>
</ul> -->
<hr />
<div class="user" *ngIf="this.identity">
  Hello <b>{{this.identity}}</b> !
  <div class="status">
    <span class="badge rounded-pill" [ngClass]="{
      'bg-success': status === 'connected',
      'bg-danger': status === 'disconnect',
      'bg-secondary': status === 'connecting'
    }">{{ status }}</span>
  </div>
  <div *ngIf="showLeaveRoomButton()">
    <button class="btn btn-warning" (click)="leaveRoom()">Leave Current Room</button>
  </div>
</div>
<hr />
<div class="search">
  <div class="mb-3">
    <label for="search-keyword" class="form-label"></label>
    <input #searchKeyword type="text" class="form-control" id="search-keyword" aria-describedby="search-keyword-helper"
      placeholder="Find your friends" (keyup)="search(searchKeyword.value)">
    <div id="search-keyword-helper" class="form-text"></div>
  </div>
</div>
<ul *ngIf="showList()" class="rooms list-group">
  <li *ngFor="let room of getRoomList()" class="room list-group-item list-group-item-action" [ngClass]="{
      'active': room.id === selectedRoom?.id,
      'bg-success-disabled': room?.joined === true,
      'text-white-disabled':room?.joined === true,
      'joined': room?.joined === true
    }" (click)="onClickOnRoom(room)" (mouseenter)="room.hovered = true" (mouseleave)="room.hovered = false">
    <div class=" d-flex w-300 justify-content-between">
      <h5 class="mb-1">{{room.displayName}}</h5>
      <small class="sub-text" [ngClass]="{'hovered' : room?.hovered === true, 'joined': room?.joined === true }">
        <!-- <span *ngIf="!room.peer.includes(this.identity)">{{room.status}}</span>
        <span *ngIf="room.peer.includes(this.identity) && room.status === 'connected'">
          {{room.status}}</span> -->
        <!-- {{room.status}} -->
        <span *ngIf="room.status === 'connected'" class="green-oval"></span>
        <span *ngIf="room.status === 'connecting'">Connecting...</span>
      </small>
    </div>
    <p *ngIf="room.peer?.length" class="mb-1 peer">{{showPeers(room.peer)}}</p>
    <p *ngIf="!(room.peer?.length)" class="mb-1">No members</p>
    <small class="sub-text" [ngClass]="{'hovered' : room?.hovered === true, 'joined': room?.joined === true }">
      {{ showRoomTips(room)}}
    </small>
  </li>
</ul>

<div *ngIf="!this.identity"><i>You have not specified your identity yet!</i></div>

<!-- <button (click)="initIdentity('Ty1')">Ty1</button>
<button (click)="initIdentity('Ty2')">Ty2</button>
<button (click)="initIdentity('Ty3')">Ty3</button>
<button (click)="check()">check</button> -->
